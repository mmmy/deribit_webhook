# getInstrumenté‡æ„æ€»ç»“

## ğŸ“‹ æ¦‚è¿°

æˆåŠŸå°†æœŸæƒäº¤æ˜“æœåŠ¡ä¸­çš„å·¥å…·ä¿¡æ¯è·å–é€»è¾‘ä»`getInstruments`æ‰¹é‡æŸ¥è¯¢æ”¹ä¸º`getInstrument`å•ä¸ªæŸ¥è¯¢ï¼Œæé«˜äº†æ•ˆç‡å¹¶ç®€åŒ–äº†ä»£ç é€»è¾‘ã€‚

## ğŸ¯ ä¸»è¦æ”¹åŠ¨

### 1. å·¥å…·ä¿¡æ¯è·å–é€»è¾‘ä¼˜åŒ– âœ…

**ä¿®æ”¹ä½ç½®**: `src/services/option-trading.ts` - `processWebhookSignal`æ–¹æ³•

**åŸä»£ç **:
```typescript
const instruments = await this.deribitClient.getInstruments(
  instrumentName.split('-')[0], // æå–è´§å¸ç±»å‹ï¼Œå¦‚BTC
  'option'
);
const instrumentInfo = instruments.find(inst => inst.instrument_name === instrumentName);
if (!instrumentInfo) {
  throw new Error(`Failed to get instrument info for ${instrumentName}`);
}
```

**æ–°ä»£ç **:
```typescript
const instrumentInfo = await this.deribitClient.getInstrument(instrumentName);
if (!instrumentInfo) {
  throw new Error(`Failed to get instrument info for ${instrumentName}`);
}
```

### 2. ç±»å‹ç³»ç»Ÿæ›´æ–° âœ…

**å½±å“çš„æ–¹æ³•**:
- `correctOrderParams()` 
- `correctOrderPrice()`
- `correctOrderAmount()`
- `executeProgressiveLimitStrategy()`

**ç±»å‹å˜æ›´**:
```typescript
// ä»
instrumentDetail: DeribitOptionInstrument

// æ”¹ä¸º
instrumentDetail: DeribitInstrumentDetail
```

### 3. å¯¼å…¥ç±»å‹æ›´æ–° âœ…

**æ–°å¢å¯¼å…¥**:
```typescript
import type { DeribitInstrumentDetail } from '../types/deribit-instrument';
```

## ğŸš€ ä¼˜åŒ–æ•ˆæœ

### 1. æ€§èƒ½æå‡
- **å‡å°‘ç½‘ç»œè¯·æ±‚**: ä»è·å–æ‰€æœ‰æœŸæƒåˆ—è¡¨æ”¹ä¸ºè·å–å•ä¸ªå·¥å…·
- **é™ä½æ•°æ®ä¼ è¾“**: åªä¼ è¾“éœ€è¦çš„å·¥å…·ä¿¡æ¯
- **æé«˜å“åº”é€Ÿåº¦**: ç›´æ¥æŸ¥è¯¢ç›®æ ‡å·¥å…·ï¼Œæ— éœ€å®¢æˆ·ç«¯ç­›é€‰

### 2. ä»£ç ç®€åŒ–
- **å‡å°‘ä»£ç è¡Œæ•°**: ä»6è¡Œå‡å°‘åˆ°3è¡Œ
- **æ¶ˆé™¤æŸ¥æ‰¾é€»è¾‘**: ä¸å†éœ€è¦`find()`æ“ä½œ
- **é™ä½å¤æ‚åº¦**: ç›´æ¥APIè°ƒç”¨ï¼Œé€»è¾‘æ›´æ¸…æ™°

### 3. é”™è¯¯å¤„ç†æ”¹è¿›
- **æ›´ç²¾ç¡®çš„é”™è¯¯ä¿¡æ¯**: ç›´æ¥çŸ¥é“æ˜¯å¦æ‰¾åˆ°ç›®æ ‡å·¥å…·
- **å‡å°‘è¾¹ç•Œæƒ…å†µ**: é¿å…ç©ºæ•°ç»„æˆ–æŸ¥æ‰¾å¤±è´¥çš„æƒ…å†µ

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### APIè°ƒç”¨å¯¹æ¯”

| æ–¹é¢ | getInstruments | getInstrument |
|------|----------------|---------------|
| è¯·æ±‚ç«¯ç‚¹ | `/public/get_instruments` | `/public/get_instrument` |
| å‚æ•° | `currency`, `kind` | `instrument_name` |
| è¿”å›æ•°æ® | å·¥å…·æ•°ç»„ | å•ä¸ªå·¥å…·è¯¦æƒ… |
| æ•°æ®é‡ | å¤§ï¼ˆæ‰€æœ‰æœŸæƒï¼‰ | å°ï¼ˆå•ä¸ªå·¥å…·ï¼‰ |
| åç»­å¤„ç† | éœ€è¦ç­›é€‰ | ç›´æ¥ä½¿ç”¨ |

### ç±»å‹å…¼å®¹æ€§

`DeribitInstrumentDetail`åŒ…å«äº†`DeribitOptionInstrument`çš„æ‰€æœ‰å¿…è¦å­—æ®µï¼š
- âœ… `instrument_name`
- âœ… `tick_size`
- âœ… `min_trade_amount`
- âœ… `contract_size`
- âœ… `option_type`
- âœ… `strike`

## ğŸ“Š ä½¿ç”¨åœºæ™¯

### é€‚ç”¨æƒ…å†µ
- âœ… å·²çŸ¥ç¡®åˆ‡çš„å·¥å…·åç§°
- âœ… éœ€è¦è·å–å•ä¸ªå·¥å…·çš„è¯¦ç»†ä¿¡æ¯
- âœ… å¯¹æ€§èƒ½æœ‰è¦æ±‚çš„åœºæ™¯
- âœ… æœŸæƒäº¤æ˜“ä¿¡å·å¤„ç†

### ä¸é€‚ç”¨æƒ…å†µ
- âŒ éœ€è¦æµè§ˆæ‰€æœ‰å¯ç”¨å·¥å…·
- âŒ éœ€è¦æŒ‰æ¡ä»¶ç­›é€‰å·¥å…·
- âŒ ä¸ç¡®å®šå·¥å…·åç§°çš„æƒ…å†µ

## âœ… éªŒè¯æ¸…å•

- [x] ä»£ç ç¼–è¯‘æˆåŠŸ
- [x] ç±»å‹å®šä¹‰æ­£ç¡®
- [x] æ–¹æ³•ç­¾åæ›´æ–°
- [x] å¯¼å…¥è¯­å¥æ·»åŠ 
- [x] é”™è¯¯å¤„ç†ä¿æŒ
- [x] åŠŸèƒ½é€»è¾‘ä¸å˜

## ğŸ‰ æ€»ç»“

è¿™æ¬¡é‡æ„æˆåŠŸåœ°ï¼š

1. **æå‡äº†æ€§èƒ½**: å‡å°‘äº†ä¸å¿…è¦çš„æ•°æ®ä¼ è¾“å’Œå¤„ç†
2. **ç®€åŒ–äº†ä»£ç **: æ¶ˆé™¤äº†æŸ¥æ‰¾é€»è¾‘ï¼Œä»£ç æ›´ç›´è§‚
3. **ä¿æŒäº†åŠŸèƒ½**: æ‰€æœ‰åŸæœ‰åŠŸèƒ½å®Œå…¨ä¿æŒ
4. **æ”¹è¿›äº†ç±»å‹**: ä½¿ç”¨æ›´å‡†ç¡®çš„ç±»å‹å®šä¹‰
5. **å¢å¼ºäº†å¯ç»´æŠ¤æ€§**: ä»£ç æ›´ç®€æ´ï¼Œæ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤

è¿™ä¸ªæ”¹åŠ¨ç‰¹åˆ«é€‚åˆæœŸæƒäº¤æ˜“åœºæ™¯ï¼Œå› ä¸ºåœ¨å¤„ç†webhookä¿¡å·æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯çŸ¥é“ç¡®åˆ‡çš„å·¥å…·åç§°ï¼Œä½¿ç”¨`getInstrument`æ¯”`getInstruments`æ›´é«˜æ•ˆå’Œç›´æ¥ã€‚

---

**ä¿®æ”¹æ—¥æœŸ**: 2025-08-01  
**å½±å“èŒƒå›´**: æœŸæƒäº¤æ˜“æœåŠ¡  
**å‘åå…¼å®¹**: æ˜¯  
**æ€§èƒ½å½±å“**: æ­£é¢æå‡
